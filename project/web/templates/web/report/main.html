{% extends 'web/base.html' %}

{% block 'title' %}Your Report{% endblock %}

{% block 'content' %}

    <div class="Content"></div>

{% endblock %}

{% block 'styles' %}
    <style type="text/css">
        body {
            font-family: 'Merriweather', sans-serif;
            font-size: 12px;
        }

        .Content {
            padding: 50px;
        }

        .Category {
            display: inline-block;
            padding: 30px;
            width: 400px;
        }

        .CategoryHeader {
            padding: 10px 30px;
            border-radius: 4px;
            background-color: #F5F5F5;
            border-bottom: 3px solid #F0F0F0;
        }

        .CategoryHeader-title {
            color: #333;
            font-family: 'Open Sans', sans-serif;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        .CategoryExplanation {
            padding: 15px 30px;
            font-style: italic;
        }

        .CategoryPosts {
            list-style-type: none;
        }

        .CategoryPost {
            display: inline-block;
            margin: 5px 10px;
            border-radius: 4px;
            border: 1px solid #ff973b;
            padding: 5px 12px;
        }
    </style>
{% endblock %}

{% block 'js' %}
    <script type="text/javascript">
        $(document).ready(function () {
            $.get('/api/v1/analysis', function (data) {
                render(data);
            });
        });

        function render(data) {
            console.log(data);

            if (data.categories) {
                var root = $('.Content');
                for (var i = 0; i < data.categories.length; i++) {
                    renderCategory(data.categories[i], root);
                }
            }
        }

        function renderCategory(c, $node) {
            var posts = '';
            for (var i = 0; i < 3; i++) {
                posts += renderPost(c.posts[i]);
            }
            var mmmarkup = '<div class="Category">'
                        +      '<header class="CategoryHeader">'
                        +          '<h3 class="CategoryHeader-title">'
                        +               c.category.name
                        +               ' (' + c.posts.length + ')'
                        +          '</h3>'
                        +      '</header>'
                        +      '<p class="CategoryExplanation">'
                        +          'Here are a few posts we found under this category, do these make sense?'
                        +      '</p>'
                        +      '<ul class="CategoryPosts">'
                        +           posts
                        +      '</ul>'
                        + '</div>'
                        ;

            $node.append(mmmarkup);
        }

        function renderPost(post) {
            return '<li class="CategoryPost">'
                +              '<p>'
                +                  post
                +              '</p>'
                +          '</li>'
                ;
        }
    </script>
{% endblock %}
